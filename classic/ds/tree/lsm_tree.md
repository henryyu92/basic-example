## LSM 树

LSM(Log-Structured Merge) 树本质上和 B+ 树一样，是一种磁盘数据的索引结构，但是和 B+ 树不同的是 LSM 树对于写请求都是一次顺序写，因此 LSM 树的写性能要远高于 B+ 树。

LSM 树一般由两部分组成：内存部分 和 磁盘部分。内存部分一般采用跳跃表来维护一个有序的解合，磁盘部分一般是多个内部数据有序的文件。

### 数据插入

LSM 树的数据插入首先会在日志文件中插入操作日志用于恢复，日志是以 append 形式写入，所以速度很快。之后将数据插入到内存树中，这里的操作是在内存中，虽然涉及排序等复杂操作，但是由于不涉及到磁盘操作所以也会很快；当内存中的数据到达一定大小之后会滚动到磁盘中形成文件，当磁盘中的文件数量达到一定阈值时就会将这些文件合并，合并的过程需要保证和每个小文件相同的性质，因此合并操作非常消耗性能。