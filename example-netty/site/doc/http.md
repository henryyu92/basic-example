## HTTP 协议

超文本传输协议(HyperText Transfer Protocol，HTTP) 是一种**应用层协议**，HTTP 协议是万维网的数据通信基础。

HTTP 协议采用了请求/响应模型，客户端向服务器发送一个请求报文，请求报文包含请求的方法、URL、协议版本、请求头和请求数据，服务器以一个状态行作为响应，响应的内容包括协议的版本、状态码、服务器信息、响应头和响应数据。

- HTTP 协议是基于请求-响应模式的，也就是说服务器端在没有接收到客户端发出的请求之前不会发送响应
- HTTP 协议是无状态的协议，即 HTTP 协议自身不对请求和响应之间的通信状态进行保存，HTTP1.1 增加了 Cookie 管理状态
- HTTP 协议是无连接的，即每次连接只处理一个请求，服务器处理完客户端的请求并收到客户端的应答后即断开连接，HTTP1.1 增加了 keep-alive 可以时服务端在返回响应之后保持连接一段时间

### 请求方法

HTTP/1.1 协议中共定义了八种方法来操作指定的资源：
- GET：GET 应该只用于读取数据，而不应当被用于产生“副作用”的操作中
- HEAD：不返回资源本身，而是返回资源的元数据信息
- POST：向指定资源提交数据，请求服务器处理，可能会创建新的资源或修改现有的资源
- PUT：向指定资源位置上传最新内容
- DELETE：删除指定位置的资源
- TRACE：回显服务器收到的请求，主要用于测试或诊断
- OPTIONS：使服务器传回该资源所支持的所有 HTTP 请求方法
- CONNECT：用于 SSL 加密服务器的连接

### 状态码

HTTP 响应的第一行是状态行，依次是 HTTP 版本号、状态码、状态描述，彼此使用空格分隔。

HTTP 响应的状态分为 5 类：
- 1xx：信息性状态码，表示接收的请求正在处理
- 2xx：成功状态码，表示请求处理完成
- 3xx：重定向状态码，表示资源已经被移动，客户端需要到新的资源地址获取
- 4xx：客户端错误状态码，表示服务器无法处理请求
- 5xx：服务器错误状态买，表示服务器处理请求出错

常见的状态码解释：
- 200：服务器成功处理了请求
- 301：资源被**永久**移除到其他位置，响应中需要包含资源新的地址
- 302：资源被**临时**移除到其他位置，响应中需要包含资源新的地址
- 304：表示客户端缓存的资源是最新的，客户端使用缓存即可。客户端在发送请求时将缓存中资源的最后修改时间发送给服务器端，服务器端如果发现资源未被修改则返回 304，否则返回 200 以及最新的资源
- 400：请求数据错误
- 403：请求被服务器拒绝
- 404：请求的资源未找到
- 500：服务器错误使其无法为请求提供服务
- 501：客户端发起的请求超出了服务器的能力范围

### HTTP 请求和响应

HTTP 请求分为三部分：请求方法、地址和协议版本，请求头，请求体：
```
# 方法、地址、协议版本
POST /test HTTP/1.1
# 请求头
Host: ip
Connection: keep-alive
Content-Type: application/json

# 请求体
name=value
```

HTTP 响应分为三部分：协议版本、状态吗，响应头，响应体：
```
HTTP/1.1 200 OK
Content-Type: text/html

<html>
...
```

常见的请求头：
- Host: ip:port             # 目的主机和端口
- Connection: keep-alive    # 保持连接
- Content-Length: 68        # 消息体的长度
- Accept: application/json, text/html, */* # 客户端接收的响应数据类型
- Content-Type: application/json    # 请求数据的类型

常见的响应头：
- Content-Type: application/json    # 服务端接收的类型